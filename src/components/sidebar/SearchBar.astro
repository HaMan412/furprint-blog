---
import { Icon } from "astro-icon/components";
import { t } from "@config";
---

<div class="p-4">
  {/* 【核心修复】添加 data-astro-reload 来禁用视图过渡，强制页面刷新 */}
  <form action="/blog/search" method="get" class="relative w-full" data-astro-reload>
    <div class="search-container w-full relative">
      <input
        type="text"
        name="q"
        placeholder={t("label.search") || "Search..."}
        class="input input-bordered w-full pl-10 pr-16 py-2"
        aria-label={t("label.search") || "Search"}
      />
      <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
        <Icon name="lucide:search" class="w-5 h-5" />
      </div>
      <button
        type="submit"
        class="absolute right-2 top-1/2 transform -translate-y-1/2 p-2"
        aria-label={t("label.search") || "Search"}
      >
        <Icon name="lucide:arrow-right" class="w-4 h-4" />
      </button>
    </div>
  </form>
</div>

<script>
  // 这个脚本不受影响，保持原样
  document.addEventListener("keydown", (e) => {
    const target = e.target as HTMLElement;
    if (e.key === "/" && target && target.tagName !== "INPUT" && target.tagName !== "TEXTAREA") {
      e.preventDefault();
      const searchInput = document.querySelector('input[name="q"]');
      if (searchInput) {
        (searchInput as HTMLInputElement).focus();
      }
    }
  });
</script>
